<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dasai Mochi - Car Dashboard Companion</title>
  
  <!-- PWA Meta -->
  <meta name="theme-color" content="#000000">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="Mochi">
  <meta name="description" content="Your cute car dashboard companion that reacts to your driving">
  
  <!-- Icons -->
  <link rel="apple-touch-icon" href="mochi-192.svg">
  <link rel="manifest" href="manifest.json">
  
  <!-- PWA Splash Screens (iOS) -->
  <link rel="apple-touch-startup-image" href="mochi-512.svg">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="mochi">
    <svg viewBox="0 0 128 64" xmlns="http://www.w3.org/2000/svg"></svg>
    <div id="status"></div>
    <div id="camera-alert">AI Camera Alert!</div>
  </div>

  <!-- Car Mode Button -->
  <button id="carModeBtn">ðŸš— Enable Car Mode</button>

  <!-- Fullscreen Button -->
  <div id="fullscreenBtn">
    <svg viewBox="0 0 24 24" fill="white">
      <path d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>
    </svg>
  </div>

  <!-- Install Prompt -->
  <div id="installPrompt">
    <p>Add Mochi to your home screen for quick access!</p>
    <button id="installButton">Install App</button>
    <button id="dismissButton">Dismiss</button>
  </div>

<!-- In the head -->
<script src="expressions.js"></script>
<script src="mochi.js"></script>
<script src="sensors.js"></script>
<script src="interactions.js"></script>
<script src="cameras.js"></script>
  
  <script>
 // PWA Install Prompt
let deferredPrompt;
let installPromptShown = false;

window.addEventListener('beforeinstallprompt', (e) => {
  e.preventDefault();
  deferredPrompt = e;
  
  // Only show prompt once and after a delay
  if (!installPromptShown) {
    setTimeout(() => {
      showInstallPrompt();
      installPromptShown = true;
    }, 10000); // Show after 10 seconds
  }
});

function showInstallPrompt() {
  if (deferredPrompt && !isAppInstalled()) {
    document.getElementById('installPrompt').style.display = 'block';
  }
}

function isAppInstalled() {
  return window.matchMedia('(display-mode: standalone)').matches || 
         window.navigator.standalone === true;
}

document.getElementById('installButton').addEventListener('click', async () => {
  document.getElementById('installPrompt').style.display = 'none';
  
  if (deferredPrompt) {
    deferredPrompt.prompt();
    const { outcome } = await deferredPrompt.userChoice;
    console.log(`User ${outcome} the install prompt`);
    deferredPrompt = null;
  }
});

document.getElementById('dismissButton').addEventListener('click', () => {
  document.getElementById('installPrompt').style.display = 'none';
});

window.addEventListener('appinstalled', () => {
  console.log('Mochi app was installed successfully');
  document.getElementById('installPrompt').style.display = 'none';
  deferredPrompt = null;
});
  </script>
</body>
</html>